Important:
* Fix IE bugs:
  * Copy EHR text works correctly now for nonmed advice but not for med advice. Med advice seems to have some poorly-formed HTML, e.g.:	<div id="et_N05BA01_6e_1" style="display: block;">	<div class="efreetext" id="eft_N05BA01_6e_1_0">	Stop</div><!-- eft_N05BA01_6e_1_0 -->	</div><!-- et_N05BA01_6e_1 -->	<div id="et_N05BA01_6e_2" style="display: none;">	<div class="efreetext" id="eft_N05BA01_6e_2_0">	Afbouwen volgens afbouwschema waarna stop</div><!-- eft_N05BA01_6e_2_0 -->	<div class="efreetext" id="eft_N05BA01_6e_2_1"></div><!-- eft_N05BA01_6e_2_1 -->	</div><!-- et_N05BA01_6e_2 -->
* Figure out "on update" statements for research tables* Think about what we know about the "doctor_id" and incorporate its use into the code.  * How do we expect the doctor_id to come in? Presumably we'll need it for OAUTH. I guess it's in the post data?
  * We will need to keep a log of OAUTH authorizations. Should we use logged_events for this? Should we change viewer_id to doctor_id in this table?  * I've added a doctor_id field to patient_advice_selection, but I will need to add code to populate it.* figure out why last test in "Test user entering values" (TestCafe) fails, even though performing the actions manually gives the correct result.
* Getting data out of EHR
  * Look into free FHIR servers and see if we can create a version of the ETL that can be included in the main repo
    https://confluence.hl7.org/display/FHIR/Public+Test+Servers
  * use of the "vernieuwen" button is probably an event we should log  * consider removing birth date entirely from the data; we only need age  * If etl can't find the patient or a BSN, it will return null. Make sure the caller handles this sensibly.* fix layout of non-med advice (if there is a free text box, checkbox lines up oddly)* other med advice free text box does not display on Consult view (should display here too)* automate tests for CDSS working on IE11
* fix testcafe acceptance tests to work with testcafe v1.16.1
* entering text in a text box should automatically check its check box (not mentioned in usability but seems like a good idea)
* search and replace nonprinting chars in refpages (looks like maybe all the HTML special chars were replaced with nonprinting chars rather than the other way around...)
* content has been added for Hoe gebruik ik... (but it's really quite bad; I guess I will make new content)
* We will need to log which users logged in and viewed records. Add this to our logging data.

Valportaal
* change display of risk gradient to match cdss
* valportaal: links to apotheek.nl
* enlarge button for valportaal
  * is this ctrl-shift-plus ? Then maybe do both for cross-browser:
    * document.body.style.MozTransform = 'scale(400%)'
    * document.body.style.zoom = '400%'
    * (be sure to check footer positioning if there is a footer)
* search button for valportaal
  * static content only?
  * https://www.plainlight.com/duckduckgo-search.html#custom-search ?
* testing of the static/ served javascript files
* make a "build valportaal vm" script
* small textual changes and links provided in spreadsheet "valportaal broken links etc.xlsx"


Required changes to rules (Ace will do these):
* Make sure every text ends with a period. If there is a free text box,
  the period should come before the free text box.
  (Laxans: should probably become Laxans aanbevolen.)
* Make sure that all texts begin with a capital letter.* add changes suggested by clinicians (see email 1 dec 2021)* make changes to ICD-10 mapping


Mid Priority:
* Add a way to clear user-entered prediction model data. This can be used by the TestCafe test to clean up after itself.
* Each acceptance test should start an instance of adfice-webserver
  * refactor adfice-webserver-runner to be more testable
  * refactor the client js (static/patient.js) to be more testable
* automate test reconnect behavior on web-socket drop
  (or adfice-webserver-runner restart)
* specify DB port, separate instance for local human testing, automated testing
* specify DB per-test, or otherwise ensure:
  * tests can be run in parallel
  * data mutations in one test do not impact a different test
  * ensure each test operates on separate data
* CI tests should use HTTPS too, possibly self-signed certs
* the "consult view" button could be renamed "Consult vernieuwen" in order to
  remove the items which have been un-checked/disabled
  * the students suggested using a "reload" icon instead
* record changes between views, connections and disconnects
  * see print logging
* styling, e.g.: viewers in yellow, hidden when 1
* test-cafe : get the innnerHTML out of an element
* sanity check choices of checkboxes
  * e.g.: "stop medication A" && "continue medication A"
* write a log archival script
  raise priority if this looks like it is growing too fast:

      SELECT table_name
           , table_rows
           , ROUND((data_length + index_length)/POWER(1024,2),1) AS size_mb
           , (data_length + index_length) AS size_bytes
        FROM information_schema.tables
       WHERE table_schema='adfice'
    ORDER BY size_bytes DESC;
* make black-and-white printer-friendly css

Low Priority:
* naming consistency thoughout the css
* naming consistency thoughout the javascript
* naming consistency thoughout the html
* tidy css page and make naming more consistant
* testcafe checkboxes contained in display:flex divs are not clickable
  * open a bug with a tiny reproducible example

Requested (not required) changes to rules:
* Rule 50: Split to personalize by age
* Rule 45: Split to personalize by +/- OH.
* Rule 45: Split into using enalapril/something else
* See if there is sufficient evidence to suggest mirabegron as alternative for G04BD
* See if there is sufficient evidence to suggest testerosterone 5 aplha reductase inhibitors (dutasteride) as alternative for G04CA

Important, but unable to do yet:
* Once we know something about how authentication will work, we may need to do
  something to prevent users without authentication from loading the data.
  * session expiration? browser caching? detect back button, return to page?
* Sending data to research database (right now we have some tables in our own database that mimic the research db tables)
* Users wanted a "close this tab" button on each refpage that closes the tab. However, the method that works on IE is considered bad practice, and might not work in the actual deployment environment. We can look into this in the actual deployment enviornment.
